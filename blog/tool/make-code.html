<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>文件到二维码转换器</title>
</head>
<body>

<h1>文件到二维码转换器</h1>
<p>选择文件生成二维码，使用<a href="./read-code.html">此软件</a>扫描二维码</p>
<form id="fileForm">
  <label for="fileInput">选择文件：</label><br>
  <input type="file" id="fileInput" name="fileInput" accept="*/*"><br><br>
  <button type="button" onclick="convertToQR()">生成二维码</button>
</form>

<div id="qrcodes"></div>

<script>
function convertToQR() {
  var fileInput = document.getElementById('fileInput');
  var files = fileInput.files;
  var qrcodesDiv = document.getElementById('qrcodes');
  qrcodesDiv.innerHTML = '';

  if (files.length > 0) {
    var file = files[0];
    var fileSize = file.size;
    var maxQRSize = 1850; // Maximum data size for QR code (in bytes)
    var chunks = Math.ceil(fileSize / maxQRSize);

    for (var i = 0; i < chunks; i++) {
      var start = i * maxQRSize;
      var end = Math.min(start + maxQRSize, fileSize);
      var chunkBlob = file.slice(start, end);
      var reader = new FileReader();
      
      reader.onload = function(event) {
        var qrCodeImg = document.createElement('img');
        qrCodeImg.src = "https://api.qrserver.com/v1/create-qr-code/?data=" + encodeURIComponent(event.target.result) + "&size=200x200";
        qrcodesDiv.appendChild(qrCodeImg);
      }

      reader.readAsDataURL(chunkBlob);
    }
  }
}
</script>

</body>
</html>
